"use strict";(self.webpackChunkmspr_arosaje_strapi=self.webpackChunkmspr_arosaje_strapi||[]).push([[8418],{95972:(J,h,t)=>{t.r(h),t.d(h,{default:()=>ie});var e=t(53547),B=t(14087),F=t(185),O=t(53979),P=t(49066),l=t(42609),v=t(86896),T=t(88767),g=t(81912),a=t(89031),C=t(42866),y=t(24969),R=t(59946),M=t(11276),m=t(67819),Q=t(61467),V=t(36856),U=t(29728),W=t(63321),j=t(36773),X=t(41054),Y=t(45697),n=t.n(Y),u=t(87561);const K=u.Ry().shape({options:u.Ry().shape({from:u.Ry().shape({name:u.Z_().required(l.translatedErrors.required),email:u.Z_().email(l.translatedErrors.email).required(l.translatedErrors.required)}).required(),response_email:u.Z_().email(l.translatedErrors.email),object:u.Z_().required(l.translatedErrors.required),message:u.Z_().required(l.translatedErrors.required)}).required(l.translatedErrors.required)}),I=({template:s,onToggle:o,onSubmit:i})=>{const{formatMessage:r}=(0,v.Z)();return e.createElement(C.P,{onClose:o,labelledBy:`${r({id:(0,a.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${r({id:(0,a.OB)(s.display),defaultMessage:s.display})}`},e.createElement(y.x,null,e.createElement(W.O,{label:`${r({id:(0,a.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${r({id:(0,a.OB)(s.display),defaultMessage:s.display})}`},e.createElement(j.$,null,r({id:(0,a.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})),e.createElement(j.$,{isCurrent:!0},r({id:(0,a.OB)(s.display),defaultMessage:s.display})))),e.createElement(X.J9,{onSubmit:i,initialValues:s,validateOnChange:!1,validationSchema:K,enableReinitialize:!0},({errors:c,values:p,handleChange:E,isSubmitting:S})=>e.createElement(l.Form,null,e.createElement(R.f,null,e.createElement(M.r,{gap:5},e.createElement(m.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.from.name.label"),defaultMessage:"Shipper name"},name:"options.from.name",onChange:E,value:p.options.from.name,error:c?.options?.from?.name,type:"text"})),e.createElement(m.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.from.email.label"),defaultMessage:"Shipper email"},name:"options.from.email",onChange:E,value:p.options.from.email,error:c?.options?.from?.email,type:"text"})),e.createElement(m.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.response_email.label"),defaultMessage:"Response email"},name:"options.response_email",onChange:E,value:p.options.response_email,error:c?.options?.response_email,type:"text"})),e.createElement(m.P,{col:6,s:12},e.createElement(l.GenericInput,{intlLabel:{id:(0,a.OB)("PopUpForm.Email.options.object.label"),defaultMessage:"Subject"},name:"options.object",onChange:E,value:p.options.object,error:c?.options?.object,type:"text"})),e.createElement(m.P,{col:12,s:12},e.createElement(Q.g,{label:r({id:(0,a.OB)("PopUpForm.Email.options.message.label"),defaultMessage:"Message"}),id:"options.message",onChange:E,value:p.options.message,error:c?.options?.message&&r({id:c.options.message,defaultMessage:c.options.message})})))),e.createElement(V.m,{startActions:e.createElement(U.z,{onClick:o,variant:"tertiary"},"Cancel"),endActions:e.createElement(U.z,{loading:S,type:"submit"},"Finish")}))))};I.propTypes={template:n().shape({display:n().string,icon:n().string,options:n().shape({from:n().shape({name:n().string,email:n().string}),message:n().string,object:n().string,response_email:n().string})}).isRequired,onSubmit:n().func.isRequired,onToggle:n().func.isRequired};const k=I;var q=t(38939),w=t(8060),Z=t(79031),d=t(37909),A=t(63237),L=t(84170),_=t(15234),G=t(52624),N=t(12028),ee=t(30815),$=t(4585),te=t(85018);const H=({canUpdate:s,onEditClick:o})=>{const{formatMessage:i}=(0,v.Z)();return e.createElement(q.i,{colCount:3,rowCount:3},e.createElement(w.h,null,e.createElement(Z.Tr,null,e.createElement(d.Th,{width:"1%"},e.createElement(A.T,null,i({id:(0,a.OB)("Email.template.table.icon.label"),defaultMessage:"icon"}))),e.createElement(d.Th,null,e.createElement(L.Z,{variant:"sigma",textColor:"neutral600"},i({id:(0,a.OB)("Email.template.table.name.label"),defaultMessage:"name"}))),e.createElement(d.Th,{width:"1%"},e.createElement(A.T,null,i({id:(0,a.OB)("Email.template.table.action.label"),defaultMessage:"action"}))))),e.createElement(_.p,null,e.createElement(Z.Tr,{...(0,l.onRowClick)({fn:()=>o("reset_password")})},e.createElement(d.Td,null,e.createElement(G.J,null,e.createElement(ee.default,{"aria-label":i({id:"global.reset-password",defaultMessage:"Reset password"})}))),e.createElement(d.Td,null,e.createElement(L.Z,null,i({id:"global.reset-password",defaultMessage:"Reset password"}))),e.createElement(d.Td,{...l.stopPropagation},e.createElement(N.h,{onClick:()=>o("reset_password"),label:i({id:(0,a.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:s&&e.createElement($.Z,null)}))),e.createElement(Z.Tr,{...(0,l.onRowClick)({fn:()=>o("email_confirmation")})},e.createElement(d.Td,null,e.createElement(G.J,null,e.createElement(te.Z,{"aria-label":i({id:(0,a.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"})}))),e.createElement(d.Td,null,e.createElement(L.Z,null,i({id:(0,a.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"}))),e.createElement(d.Td,{...l.stopPropagation},e.createElement(N.h,{onClick:()=>o("email_confirmation"),label:i({id:(0,a.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:s&&e.createElement($.Z,null)})))))};H.propTypes={canUpdate:n().bool.isRequired,onEditClick:n().func.isRequired};const ae=H,le=async()=>{const{get:s}=(0,l.getFetchClient)(),{data:o}=await s((0,a.Gc)("email-templates"));return o},se=s=>{const{put:o}=(0,l.getFetchClient)();return o((0,a.Gc)("email-templates"),s)},ne=()=>e.createElement(l.CheckPagePermissions,{permissions:g.Z.readEmailTemplates},e.createElement(oe,null)),oe=()=>{const{formatMessage:s}=(0,v.Z)(),{trackUsage:o}=(0,l.useTracking)(),{notifyStatus:i}=(0,B.G)(),r=(0,l.useNotification)(),{lockApp:c,unlockApp:p}=(0,l.useOverlayBlocker)(),E=(0,e.useRef)(o),S=(0,T.useQueryClient)();(0,l.useFocusWhenNavigate)();const[re,me]=(0,e.useState)(!1),[x,de]=(0,e.useState)(null),ce=(0,e.useMemo)(()=>({update:g.Z.updateEmailTemplates}),[]),{isLoading:ue,allowedActions:{canUpdate:pe}}=(0,l.useRBAC)(ce),{status:Ee,data:D}=(0,T.useQuery)("email-templates",()=>le(),{onSuccess(){i(s({id:(0,a.OB)("Email.template.data.loaded"),defaultMessage:"Email templates has been loaded"}))},onError(){r({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),ge=ue||Ee!=="success",b=()=>{me(f=>!f)},fe=f=>{de(f),b()},z=(0,T.useMutation)(f=>se({"email-templates":f}),{async onSuccess(){await S.invalidateQueries("email-templates"),r({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}}),E.current("didEditEmailTemplates"),p(),b()},onError(){r({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),p()},refetchActive:!0}),{isLoading:ve}=z,Te=f=>{c(),E.current("willEditEmailTemplates");const ye={...D,[x]:f};z.mutate(ye)};return ge?e.createElement(F.o,{"aria-busy":"true"},e.createElement(l.SettingsPageTitle,{name:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(O.T,{title:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(P.D,null,e.createElement(l.LoadingIndicatorPage,null))):e.createElement(F.o,{"aria-busy":ve},e.createElement(l.SettingsPageTitle,{name:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(O.T,{title:s({id:(0,a.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(P.D,null,e.createElement(ae,{onEditClick:fe,canUpdate:pe}),re&&e.createElement(k,{template:D[x],onToggle:b,onSubmit:Te})))},ie=ne},89031:(J,h,t)=>{t.d(h,{YX:()=>O,Gc:()=>v,OB:()=>T.Z});var e=t(41609),B=t.n(e);const O=g=>Object.keys(g).reduce((a,C)=>{const y=g[C].controllers,R=Object.keys(y).reduce((M,m)=>(B()(y[m])||(M[m]=y[m]),M),{});return B()(R)||(a[C]={controllers:R}),a},{});var P=t(31498);const v=g=>`/${P.Z}/${g}`;var T=t(84757)}}]);
