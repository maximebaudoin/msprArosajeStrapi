"use strict";(self.webpackChunkmspr_arosaje_strapi=self.webpackChunkmspr_arosaje_strapi||[]).push([[4263],{50935:(Z,c,e)=>{e.d(c,{R:()=>m});var t=e(42609),a=e(80129),r=e(88767);function m(d={},i={}){const{id:s="",...u}=d,l=(0,a.stringify)(u,{encode:!1}),{get:o}=(0,t.useFetchClient)(),{data:n,isError:h,isLoading:D,refetch:A}=(0,r.useQuery)(["users",s,u],async()=>{const{data:{data:O}}=await o(`/admin/users/${s}${l?`?${l}`:""}`);return O},i);let g=[];return s&&n?g=[n]:Array.isArray(n?.results)&&(g=n.results),{users:g,pagination:n?.pagination??null,isLoading:D,isError:h,refetch:A}}},22282:(Z,c,e)=>{e.r(c),e.d(c,{default:()=>Ee});var t=e(53547),a=e(42609),r=e(16550),m=e(87751),d=e(87462),i=e(15861),s=e(70885),u=e(64687),l=e.n(u),o=e(185),n=e(53979),h=e(29728),D=e(49066),A=e(41580),g=e(11047),O=e(84170),R=e(11276),T=e(67819),$=e(85018),F=e(67109),G=e(41054),H=e(27361),C=e.n(H),Y=e(57557),Q=e.n(Y),V=e(78718),x=e.n(V),J=e(45697),y=e.n(J),ie=e(86896),le=e(50935),b=e(19631),de=e(81288),ce=e(17405);const ue=async(W,K)=>{const{put:L}=(0,a.getFetchClient)(),{data:B}=await L(`/admin/users/${W}`,K);return B.data},me=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]];var ge=function(){return window&&window.strapi&&window.strapi.isEE?e(12201).Z:e(31605).Z}(),_=["email","firstname","lastname","username","isActive","roles"],q=function(K){var L=K.canUpdate,B=(0,ie.Z)(),p=B.formatMessage,k=(0,r.$B)("/settings/users/:id"),S=k.params.id,fe=(0,r.k6)(),ve=fe.push,Me=(0,a.useAppInfo)(),he=Me.setUserDisplayName,N=(0,a.useNotification)(),ee=(0,a.useOverlayBlocker)(),Pe=ee.lockApp,ye=ee.unlockApp;(0,a.useFocusWhenNavigate)();var te=(0,le.R)({id:S},{onError:function(v){var E=v.response.status;E===403?(N({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),ve("/")):N({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),Ae=(0,s.Z)(te.users,1),P=Ae[0],ae=te.isLoading,Le=function(){var f=(0,i.Z)(l().mark(function v(E,U){var z,j,I,w,ne;return l().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return Pe(),M.prev=1,M.next=4,ue(S,Q()(E,"confirmPassword"));case 4:z=M.sent,N({type:"success",message:p({id:"notification.success.saved",defaultMessage:"Saved"})}),j=a.auth.getUserInfo(),S.toString()===j.id.toString()&&(a.auth.setUserInfo(z),I=C()(E,"username")||(0,b.Pp)(E.firstname,E.lastname),he(I)),U.setValues(x()(E,_)),M.next=17;break;case 11:M.prev=11,M.t0=M.catch(1),w=(0,b.Iz)(M.t0.response.data),ne=Object.keys(w).reduce(function(re,oe){return re[oe]=w[oe].id,re},{}),U.setErrors(ne),N({type:"warning",message:C()(M.t0,"response.data.error.message","notification.error")});case 17:ye();case 18:case"end":return M.stop()}},v,null,[[1,11]])}));return function(E,U){return f.apply(this,arguments)}}(),De=ae?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},X=Object.keys(x()(P,_)).reduce(function(f,v){return v==="roles"?(f[v]=(P?.roles||[]).map(function(E){var U=E.id;return U}),f):(f[v]=P?.[v],f)},{}),Oe=X.username||(0,b.Pp)(X.firstname,X.lastname),se=p(De,{name:Oe});return ae?t.createElement(o.o,{"aria-busy":"true"},t.createElement(a.SettingsPageTitle,{name:"Users"}),t.createElement(n.T,{primaryAction:t.createElement(h.z,{disabled:!0,startIcon:t.createElement($.Z,null),type:"button",size:"L"},p({id:"global.save",defaultMessage:"Save"})),title:se,navigationAction:t.createElement(a.Link,{startIcon:t.createElement(F.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},p({id:"global.back",defaultMessage:"Back"}))}),t.createElement(D.D,null,t.createElement(a.LoadingIndicatorPage,null))):t.createElement(o.o,null,t.createElement(a.SettingsPageTitle,{name:"Users"}),t.createElement(G.J9,{onSubmit:Le,initialValues:X,validateOnChange:!1,validationSchema:ce.YM},function(f){var v=f.errors,E=f.values,U=f.handleChange,z=f.isSubmitting;return t.createElement(a.Form,null,t.createElement(n.T,{primaryAction:t.createElement(h.z,{disabled:z||!L,startIcon:t.createElement($.Z,null),loading:z,type:"submit",size:"L"},p({id:"global.save",defaultMessage:"Save"})),title:se,navigationAction:t.createElement(a.Link,{startIcon:t.createElement(F.Z,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},p({id:"global.back",defaultMessage:"Back"}))}),t.createElement(D.D,null,P?.registrationToken&&t.createElement(A.x,{paddingBottom:6},t.createElement(ge,{registrationToken:P.registrationToken})),t.createElement(g.k,{direction:"column",alignItems:"stretch",gap:7},t.createElement(A.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(g.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(O.Z,{variant:"delta",as:"h2"},p({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),t.createElement(R.r,{gap:5},me.map(function(j){return j.map(function(I){return t.createElement(T.P,(0,d.Z)({key:I.name},I.size),t.createElement(a.GenericInput,(0,d.Z)({},I,{disabled:!L,error:v[I.name],onChange:U,value:E[I.name]||""})))})})))),t.createElement(A.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(g.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(O.Z,{variant:"delta",as:"h2"},p({id:"global.roles",defaultMessage:"User's role"})),t.createElement(R.r,{gap:5},t.createElement(T.P,{col:6,xs:12},t.createElement(de.Z,{disabled:!L,error:v.roles,onChange:U,value:E.roles}))))))))}))};q.propTypes={canUpdate:y().bool.isRequired};const pe=q,Ee=()=>{const W=(0,a.useNotification)(),K=(0,t.useMemo)(()=>({read:m.Z.settings.users.read,update:m.Z.settings.users.update}),[]),{isLoading:L,allowedActions:{canRead:B,canUpdate:p}}=(0,a.useRBAC)(K),{state:k}=(0,r.TH)(),S=k?.from??"/";return(0,t.useEffect)(()=>{L||!B&&!p&&W({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[L,B,p,W]),L?t.createElement(a.LoadingIndicatorPage,null):!B&&!p?t.createElement(r.l_,{to:S}):t.createElement(pe,{canUpdate:p})}},82464:(Z,c,e)=>{e.d(c,{Z:()=>l});var t=e(53547),a=e(12028),r=e(42609),m=e(65186),d=e(45697),i=e.n(d),s=e(86896);const u=({children:o,target:n})=>{const h=(0,r.useNotification)(),{formatMessage:D}=(0,s.Z)(),{copy:A}=(0,r.useClipboard)(),g=D({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),O=async()=>{await A(n)&&h({type:"info",message:{id:"notification.link-copied"}})};return t.createElement(r.ContentBox,{endAction:t.createElement(a.h,{label:g,noBorder:!0,icon:t.createElement(m.Z,null),onClick:O}),title:n,titleEllipsis:!0,subtitle:o,icon:t.createElement("span",{style:{fontSize:32}},"\u2709\uFE0F"),iconBackground:"neutral100"})};u.propTypes={children:i().oneOfType([i().element,i().string]).isRequired,target:i().string.isRequired};const l=u},31605:(Z,c,e)=>{e.d(c,{Z:()=>u});var t=e(53547),a=e(45697),r=e.n(a),m=e(86896),d=e(63871),i=e(82464);const s=({registrationToken:l})=>{const{formatMessage:o}=(0,m.Z)(),n=`${window.location.origin}${d.Z}auth/register?registrationToken=${l}`;return t.createElement(i.Z,{target:n},o({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:r().string};const u=s},81288:(Z,c,e)=>{e.d(c,{Z:()=>O});var t=e(53547),a=e(40619),r=e(82562),m=e(42609),d=e(86647),i=e(45697),s=e.n(i),u=e(86896),l=e(88767),o=e(88972);const n=(0,o.F4)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,h=o.ZP.div`
  animation: ${n} 2s infinite linear;
`,D=()=>t.createElement(h,null,t.createElement(d.Z,null)),A=async()=>{const{get:R}=(0,m.getFetchClient)(),{data:T}=await R("/admin/roles");return T.data},g=({disabled:R,error:T,onChange:$,value:F})=>{const{status:G,data:H}=(0,l.useQuery)(["roles"],A,{staleTime:5e4}),{formatMessage:C}=(0,u.Z)(),Y=T?C({id:T,defaultMessage:T}):"",Q=C({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),V=C({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),x=C({id:"app.components.Select.placeholder",defaultMessage:"Select"}),J=G==="loading"?t.createElement(D,null):void 0;return t.createElement(a.P,{id:"roles",disabled:R,error:Y,hint:V,label:Q,name:"roles",onChange:y=>{$({target:{name:"roles",value:y}})},placeholder:x,multi:!0,startIcon:J,value:F.map(y=>y.toString()),withTags:!0,required:!0},(H||[]).map(y=>t.createElement(r.W,{key:y.id,value:y.id.toString()},C({id:`global.${y.code}`,defaultMessage:y.name}))))};g.defaultProps={disabled:!1,error:void 0},g.propTypes={disabled:s().bool,error:s().string,onChange:s().func.isRequired,value:s().array.isRequired};const O=g},17405:(Z,c,e)=>{e.d(c,{YM:()=>l,Rw:()=>d});var t=e(87561),a=e(42609);const r={firstname:t.Z_().trim().required(a.translatedErrors.required),lastname:t.Z_(),email:t.Z_().email(a.translatedErrors.email).lowercase().required(a.translatedErrors.required),username:t.Z_().nullable(),password:t.Z_().min(8,a.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:t.Z_().min(8,a.translatedErrors.minLength).oneOf([t.iH("password"),null],"components.Input.error.password.noMatch").when("password",(o,n)=>o?n.required(a.translatedErrors.required):n)},d={...r,currentPassword:t.Z_().when(["password","confirmPassword"],(o,n,h)=>o||n?h.required(a.translatedErrors.required):h),preferedLanguage:t.Z_().nullable()},s={roles:t.IX().min(1,a.translatedErrors.required).required(a.translatedErrors.required)},l=t.Ry().shape({...r,isActive:t.Xg(),...s})},12201:(Z,c,e)=>{e.d(c,{Z:()=>u});var t=e(53547),a=e(45697),r=e.n(a),m=e(86896),d=e(63871),i=e(82464);const s=({registrationToken:l})=>{const{formatMessage:o}=(0,m.Z)();return l?t.createElement(i.Z,{target:`${window.location.origin}${d.Z}auth/register?registrationToken=${l}`},o({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})):t.createElement(i.Z,{target:`${window.location.origin}${d.Z}auth/login`},o({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};s.defaultProps={registrationToken:""},s.propTypes={registrationToken:r().string};const u=s}}]);
