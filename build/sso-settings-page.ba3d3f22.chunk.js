"use strict";(self.webpackChunkmspr_arosaje_strapi=self.webpackChunkmspr_arosaje_strapi||[]).push([[302],{40316:(X,m,e)=>{e.r(m),e.d(m,{SingleSignOn:()=>v,default:()=>H});var t=e(53547),L=e(17034),M=e(185),C=e(53979),y=e(29728),I=e(49066),O=e(11047),P=e(84170),b=e(11276),g=e(67819),A=e(93127),T=e(40619),D=e(82562),f=e(67730),o=e(42609),F=e(85018),Z=e(18446),k=e.n(Z),x=e(86896),h=e(51319),S=e(87751),B=e(19631),r=e(87561);const G=r.Ry().shape({autoRegister:r.Xg().required(o.translatedErrors.required),defaultRole:r.nK().when("autoRegister",(a,n)=>a?n.required(o.translatedErrors.required):n.nullable()),ssoLockedRoles:r.IX().of(r.nK().when("ssoLockedRoles",(a,n)=>a?n.required(o.translatedErrors.required):n.nullable()))}),R={...S.Z.settings.sso,readRoles:S.Z.settings.roles.read},v=()=>{const{formatMessage:a}=(0,x.Z)(),{isLoading:n,allowedActions:{canUpdate:u,canReadRoles:j}}=(0,o.useRBAC)(R),[{formErrors:l,initialData:z,isLoading:K,modifiedData:i,showHeaderButtonLoader:N},V,{handleChange:d,handleSubmit:U}]=(0,h.G4)((0,B.IF)("providers/options"),G,()=>{},["autoRegister","defaultRole","ssoLockedRoles"]),{roles:E}=(0,h.bF)(j);(0,o.useFocusWhenNavigate)();const W=n||K;(0,t.useEffect)(()=>{if(l.defaultRole){const s='[name="defaultRole"]';document.querySelector(s).focus()}},[l]);const p=k()(z,i);return t.createElement(L.A,null,t.createElement(o.SettingsPageTitle,{name:"SSO"}),t.createElement(M.o,{tabIndex:-1},t.createElement("form",{onSubmit:s=>{if(p){s.preventDefault();return}U(s)}},t.createElement(C.T,{primaryAction:t.createElement(y.z,{"data-testid":"save-button",disabled:p,loading:N,startIcon:t.createElement(F.Z,null),type:"submit",size:"L"},a({id:"global.save",defaultMessage:"Save"})),title:a({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:a({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),t.createElement(I.D,null,W?t.createElement(o.LoadingIndicatorPage,null):t.createElement(O.k,{direction:"column",alignItems:"stretch",gap:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},t.createElement(P.Z,{variant:"delta",as:"h2"},a({id:"global.settings",defaultMessage:"Settings"})),t.createElement(b.r,{gap:4},t.createElement(g.P,{col:6,m:6,s:12},t.createElement(A.s,{"aria-label":"autoRegister","data-testid":"autoRegister",disabled:!u,checked:i.autoRegister,hint:a({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:a({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:a({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:a({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:s=>{d({target:{name:"autoRegister",value:s.target.checked}})}})),t.createElement(g.P,{col:6,m:6,s:12},t.createElement(T.P,{disabled:!u,hint:a({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:l.defaultRole?a({id:l.defaultRole.id,defaultMessage:l.defaultRole.id}):"",label:a({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:s=>{d({target:{name:"defaultRole",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:i.defaultRole},E.map(({id:s,name:c})=>t.createElement(D.W,{key:s,value:s.toString()},c)))),t.createElement(g.P,{col:6,m:6,s:12},t.createElement(f.NU,{disabled:!u,hint:a({id:"Settings.sso.form.localAuthenticationLock.description",defaultMessage:"Select the roles for which you want to disable the local authentication"}),error:l.ssoLockedRoles?a({id:l.ssoLockedRoles.id,defaultMessage:l.ssoLockedRoles.id}):"",label:a({id:"Settings.sso.form.localAuthenticationLock.label",defaultMessage:"Local authentication lock-out"}),name:"ssoLockedRoles",onChange:s=>{d({target:{name:"ssoLockedRoles",value:s}})},placeholder:a({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),onClear:()=>{d({target:{name:"ssoLockedRoles",emptyArray:[]}})},value:i.ssoLockedRoles||[],withTags:!0},E.map(({id:s,name:c})=>t.createElement(f.ML,{key:s,value:s.toString()},c))))))))))},H=()=>t.createElement(o.CheckPagePermissions,{permissions:R.main},t.createElement(v,null))}}]);
