"use strict";(self.webpackChunkmspr_arosaje_strapi=self.webpackChunkmspr_arosaje_strapi||[]).push([[9460],{98352:(x,p,e)=>{e.r(p),e.d(p,{default:()=>j});var t=e(53547),v=e(14087),S=e(185),h=e(53979),E=e(49066),A=e(29728),O=e(41580),M=e(11047),r=e(84170),d=e(11276),c=e(67819),m=e(40619),y=e(82562),n=e(42609),u=e(85018),N=e(41054),Z=e(86896),B=e(88767),T=e(81912),a=e(89031);const z=async()=>{const{get:i}=(0,n.getFetchClient)(),{data:o}=await i((0,a.Gc)("advanced"));return o},G=i=>{const{put:o}=(0,n.getFetchClient)();return o((0,a.Gc)("advanced"),i)},I=[{intlLabel:{id:(0,a.OB)("EditForm.inputToggle.label.email"),defaultMessage:"One account per email address"},description:{id:(0,a.OB)("EditForm.inputToggle.description.email"),defaultMessage:"Disallow the user to create multiple accounts using the same email address with different authentication providers."},name:"unique_email",type:"bool",size:{col:12,xs:12}},{intlLabel:{id:(0,a.OB)("EditForm.inputToggle.label.sign-up"),defaultMessage:"Enable sign-ups"},description:{id:(0,a.OB)("EditForm.inputToggle.description.sign-up"),defaultMessage:"When disabled (OFF), the registration process is forbidden. No one can subscribe anymore no matter the used provider."},name:"allow_register",type:"bool",size:{col:12,xs:12}},{intlLabel:{id:(0,a.OB)("EditForm.inputToggle.label.email-reset-password"),defaultMessage:"Reset password page"},description:{id:(0,a.OB)("EditForm.inputToggle.description.email-reset-password"),defaultMessage:"URL of your application's reset password page."},placeholder:{id:(0,a.OB)("EditForm.inputToggle.placeholder.email-reset-password"),defaultMessage:"ex: https://youtfrontend.com/reset-password"},name:"email_reset_password",type:"text",size:{col:6,xs:12}},{intlLabel:{id:(0,a.OB)("EditForm.inputToggle.label.email-confirmation"),defaultMessage:"Enable email confirmation"},description:{id:(0,a.OB)("EditForm.inputToggle.description.email-confirmation"),defaultMessage:"When enabled (ON), new registered users receive a confirmation email."},name:"email_confirmation",type:"bool",size:{col:12,xs:12}},{intlLabel:{id:(0,a.OB)("EditForm.inputToggle.label.email-confirmation-redirection"),defaultMessage:"Redirection url"},description:{id:(0,a.OB)("EditForm.inputToggle.description.email-confirmation-redirection"),defaultMessage:"After you confirmed your email, choose where you will be redirected."},placeholder:{id:(0,a.OB)("EditForm.inputToggle.placeholder.email-confirmation-redirection"),defaultMessage:"ex: https://youtfrontend.com/email-confirmation"},name:"email_confirmation_redirection",type:"text",size:{col:6,xs:12}}];var g=e(87561);const L=new RegExp("(^$)|((.+:\\/\\/.*)(d*)\\/?(.*))"),D=g.Ry().shape({email_confirmation_redirection:g.nK().when("email_confirmation",{is:!0,then:g.Z_().matches(L).required(),otherwise:g.Z_().nullable()}),email_reset_password:g.Z_(n.translatedErrors.string).matches(L,n.translatedErrors.regex).nullable()}),U=()=>t.createElement(n.CheckPagePermissions,{permissions:T.Z.readAdvancedSettings},t.createElement(H,null)),H=()=>{const{formatMessage:i}=(0,Z.Z)(),o=(0,n.useNotification)(),{lockApp:w,unlockApp:b}=(0,n.useOverlayBlocker)(),{notifyStatus:W}=(0,v.G)(),Q=(0,B.useQueryClient)();(0,n.useFocusWhenNavigate)();const $=(0,t.useMemo)(()=>({update:T.Z.updateAdvancedSettings}),[]),{isLoading:X,allowedActions:{canUpdate:J}}=(0,n.useRBAC)($),{status:K,data:P}=(0,B.useQuery)("advanced",()=>z(),{onSuccess(){W(i({id:(0,a.OB)("Form.advancedSettings.data.loaded"),defaultMessage:"Advanced settings data has been loaded"}))},onError(){o({type:"warning",message:{id:(0,a.OB)("notification.error"),defaultMessage:"An error occured"}})}}),V=X||K!=="success",R=(0,B.useMutation)(l=>G(l),{async onSuccess(){await Q.invalidateQueries("advanced"),o({type:"success",message:{id:(0,a.OB)("notification.success.saved"),defaultMessage:"Saved"}}),b()},onError(){o({type:"warning",message:{id:(0,a.OB)("notification.error"),defaultMessage:"An error occured"}}),b()},refetchActive:!0}),{isLoading:Y}=R,k=async l=>{w();const f=l.email_confirmation?l.email_confirmation_redirection:"";await R.mutateAsync({...l,email_confirmation_redirection:f})};return V?t.createElement(S.o,{"aria-busy":"true"},t.createElement(n.SettingsPageTitle,{name:i({id:(0,a.OB)("HeaderNav.link.advancedSettings"),defaultMessage:"Advanced Settings"})}),t.createElement(h.T,{title:i({id:(0,a.OB)("HeaderNav.link.advancedSettings"),defaultMessage:"Advanced Settings"})}),t.createElement(E.D,null,t.createElement(n.LoadingIndicatorPage,null))):t.createElement(S.o,{"aria-busy":Y},t.createElement(n.SettingsPageTitle,{name:i({id:(0,a.OB)("HeaderNav.link.advancedSettings"),defaultMessage:"Advanced Settings"})}),t.createElement(N.J9,{onSubmit:k,initialValues:P.settings,validateOnChange:!1,validationSchema:D,enableReinitialize:!0},({errors:l,values:f,handleChange:C,isSubmitting:q})=>t.createElement(n.Form,null,t.createElement(h.T,{title:i({id:(0,a.OB)("HeaderNav.link.advancedSettings"),defaultMessage:"Advanced Settings"}),primaryAction:t.createElement(A.z,{loading:q,type:"submit",disabled:!J,startIcon:t.createElement(u.Z,null),size:"S"},i({id:"global.save",defaultMessage:"Save"}))}),t.createElement(E.D,null,t.createElement(O.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},t.createElement(M.k,{direction:"column",alignItems:"stretch",gap:4},t.createElement(r.Z,{variant:"delta",as:"h2"},i({id:"global.settings",defaultMessage:"Settings"})),t.createElement(d.r,{gap:6},t.createElement(c.P,{col:6,s:12},t.createElement(m.P,{label:i({id:(0,a.OB)("EditForm.inputSelect.label.role"),defaultMessage:"Default role for authenticated users"}),value:f.default_role,hint:i({id:(0,a.OB)("EditForm.inputSelect.description.role"),defaultMessage:"It will attach the new authenticated user to the selected role."}),onChange:s=>C({target:{name:"default_role",value:s}})},P.roles.map(s=>t.createElement(y.W,{key:s.type,value:s.type},s.name)))),I.map(s=>{let F=f[s.name];return F||(F=s.type==="bool"?!1:""),t.createElement(c.P,{key:s.name,...s.size},t.createElement(n.GenericInput,{...s,value:F,error:l[s.name],disabled:s.name==="email_confirmation_redirection"&&f.email_confirmation===!1,onChange:C}))}))))))))},j=U},89031:(x,p,e)=>{e.d(p,{YX:()=>h,Gc:()=>O,OB:()=>M.Z});var t=e(41609),v=e.n(t);const h=r=>Object.keys(r).reduce((d,c)=>{const m=r[c].controllers,y=Object.keys(m).reduce((n,u)=>(v()(m[u])||(n[u]=m[u]),n),{});return v()(y)||(d[c]={controllers:y}),d},{});var E=e(31498);const O=r=>`/${E.Z}/${r}`;var M=e(84757)}}]);
