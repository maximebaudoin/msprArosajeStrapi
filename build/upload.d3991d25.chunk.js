"use strict";(self.webpackChunkmspr_arosaje_strapi=self.webpackChunkmspr_arosaje_strapi||[]).push([[3650],{17316:($t,_,t)=>{t.r(_),t.d(_,{default:()=>Bt});var e=t(53547),ee=t(185),m=t(42609),Le=t(64593),L=t(86896),D=t(16550),Be=t(60862),P=t(55994),i=t(57197),R=t(41580),x=t(84170),Ae=t(17034),Ze=t(36989),Te=t(92155),b=t(12028),De=t(49066),te=t(67819),O=t(11047),Oe=t(63237),Pe=t(70004),Re=t(78114),xe=t(50738),Ie=t(29729),ze=t(4585),ae=t(80129),Ue=t(73727),G=t(88972),Qe=t(92585),Ve=t(80845),$e=t(78971),I=t(98101),be=t(24652),Ge=t(45697),g=t.n(Ge);const W=({pagination:n})=>e.createElement(R.x,{paddingTop:6},e.createElement(O.k,{alignItems:"flex-end",justifyContent:"space-between"},e.createElement(m.PageSizeURLQuery,null),e.createElement(m.PaginationURLQuery,{pagination:n})));W.defaultProps={pagination:{pageCount:0,pageSize:10,total:0}},W.propTypes={pagination:g().shape({page:g().number,pageCount:g().number,pageSize:g().number,total:g().number})};var We=t(27954),He=t(11357),je=t(33012),f=t(49826),Ne=t(73817),Ke=t(42047),Je=t(44466),Xe=t(31817),Ye=t(16838),ke=t(15537),Z=t(29728),we=t(20022),qe=t(2967);const ne=({selected:n,onSuccess:l})=>{const{formatMessage:o}=(0,L.Z)(),[r,d]=(0,e.useState)(!1),{isLoading:c,remove:v}=(0,qe.K)(),E=async()=>{await v(n),l()};return e.createElement(e.Fragment,null,e.createElement(Z.z,{variant:"danger-light",size:"S",startIcon:e.createElement(we.Z,null),onClick:()=>d(!0)},o({id:"global.delete",defaultMessage:"Delete"})),e.createElement(m.ConfirmDialog,{isConfirmButtonLoading:c,isOpen:r,onToggleDialog:()=>d(!1),onConfirm:E}))};ne.propTypes={selected:g().arrayOf(f.pw,f.nx).isRequired,onSuccess:g().func.isRequired};var _e=t(32605),se=t(42866),le=t(59946),et=t(77197),tt=t(24969),at=t(11276),nt=t(19270),st=t(36856),lt=t(41054),ot=t(41609),rt=t.n(ot),oe=t(88767);const it=()=>{const n=(0,m.useNotification)(),l=(0,oe.useQueryClient)(),o=(0,i.IF)("actions/bulk-move"),{post:r}=(0,m.useFetchClient)(),d=({destinationFolderId:E,filesAndFolders:u})=>{const h=u.reduce((p,s)=>{const{id:B,type:M}=s,T=M==="asset"?"fileIds":"folderIds";return p[T]||(p[T]=[]),p[T].push(B),p},{});return r(o,{...h,destinationFolderId:E})},c=(0,oe.useMutation)(d,{onSuccess(E){const{data:{data:u}}=E;u?.files?.length>0&&(l.refetchQueries([P.Z,"assets"],{active:!0}),l.refetchQueries([P.Z,"asset-count"],{active:!0})),l.refetchQueries([P.Z,"folders"],{active:!0}),n({type:"success",message:{id:(0,i.OB)("modal.move.success-label"),defaultMessage:"Elements have been moved successfully."}})}});return{...c,move:(E,u)=>c.mutateAsync({destinationFolderId:E,filesAndFolders:u})}};var dt=t(20796),ct=t(66951);const H=({onClose:n,selected:l,currentFolder:o})=>{const{formatMessage:r}=(0,L.Z)(),{data:d,isLoading:c}=(0,dt.v)(),{move:v}=it();if(!d)return null;const E=async(p,{setErrors:s})=>{try{await v(p.destination.value,l),n()}catch(B){const T=(0,m.normalizeAPIError)(B).errors.reduce((z,F)=>(z[F.values?.path?.length||"destination"]=F.defaultMessage,z),{});rt()(T)||s(T)}},u=()=>{n()};if(c)return e.createElement(se.P,{onClose:u,labelledBy:"title"},e.createElement(le.f,null,e.createElement(O.k,{justifyContent:"center",paddingTop:4,paddingBottom:4},e.createElement(et.a,null,r({id:(0,i.OB)("content.isLoading"),defaultMessage:"Content is loading."})))));const h={destination:{value:o?.id||"",label:o?.name||d[0].label}};return e.createElement(se.P,{onClose:u,labelledBy:"title"},e.createElement(lt.J9,{validateOnChange:!1,onSubmit:E,initialValues:h},({values:p,errors:s,setFieldValue:B})=>e.createElement(m.Form,{noValidate:!0},e.createElement(tt.x,null,e.createElement(x.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"title"},r({id:(0,i.OB)("modal.folder.move.title"),defaultMessage:"Move elements to"}))),e.createElement(le.f,null,e.createElement(at.r,{gap:4},e.createElement(te.P,{xs:12,col:12},e.createElement(O.k,{direction:"column",alignItems:"stretch",gap:1},e.createElement(nt.Q,{htmlFor:"folder-destination"},r({id:(0,i.OB)("form.input.label.folder-location"),defaultMessage:"Location"})),e.createElement(ct.Z,{options:d,onChange:M=>{B("destination",M)},defaultValue:p.destination,name:"destination",menuPortalTarget:document.querySelector("body"),inputId:"folder-destination",error:s?.destination,ariaErrorMessage:"destination-error"}),s.destination&&e.createElement(x.Z,{variant:"pi",as:"p",id:"folder-destination-error",textColor:"danger600"},s.destination))))),e.createElement(st.m,{startActions:e.createElement(Z.z,{onClick:u,variant:"tertiary",name:"cancel"},r({id:"cancel",defaultMessage:"Cancel"})),endActions:e.createElement(Z.z,{type:"submit",loading:c},r({id:"modal.folder.move.submit",defaultMessage:"Move"}))}))))};H.defaultProps={currentFolder:void 0},H.propTypes={onClose:g().func.isRequired,currentFolder:f.nx,selected:g().arrayOf(f.nx,f.pw).isRequired};const j=({selected:n,onSuccess:l,currentFolder:o})=>{const{formatMessage:r}=(0,L.Z)(),[d,c]=(0,e.useState)(!1),v=()=>{c(!1),l()};return e.createElement(e.Fragment,null,e.createElement(Z.z,{variant:"secondary",size:"S",startIcon:e.createElement(_e.Z,null),onClick:()=>c(!0)},r({id:"global.move",defaultMessage:"Move"})),d&&e.createElement(H,{currentFolder:o,onClose:v,selected:n}))};j.defaultProps={currentFolder:void 0},j.propTypes={onSuccess:g().func.isRequired,currentFolder:f.nx,selected:g().arrayOf(f.pw,f.nx).isRequired};const N=({selected:n,onSuccess:l,currentFolder:o})=>{const{formatMessage:r}=(0,L.Z)();return e.createElement(O.k,{gap:2,paddingBottom:5},e.createElement(x.Z,{variant:"epsilon",textColor:"neutral600"},r({id:(0,ke.Z)("list.assets.selected"),defaultMessage:"{numberFolders, plural, one {1 folder} other {# folders}} - {numberAssets, plural, one {1 asset} other {# assets}} selected"},{numberFolders:n.filter(({type:d})=>d==="folder").length,numberAssets:n.filter(({type:d})=>d==="asset").length})),e.createElement(ne,{selected:n,onSuccess:l}),e.createElement(j,{currentFolder:o,selected:n,onSuccess:l}))};N.defaultProps={currentFolder:void 0},N.propTypes={onSuccess:g().func.isRequired,currentFolder:f.nx,selected:g().arrayOf(f.pw,f.nx).isRequired};var ut=t(65169),K=t(96315),mt=t(70088);const gt=({isFiltering:n,canCreate:l,canRead:o})=>n?{id:"list.assets-empty.title-withSearch",defaultMessage:"There are no elements with the applied filters"}:o?l?{id:"list.assets.empty-upload",defaultMessage:"Upload your first assets..."}:{id:"list.assets.empty",defaultMessage:"Media Library is empty"}:{id:"header.actions.no-permissions",defaultMessage:"No permissions to view"},re=({canCreate:n,isFiltering:l,canRead:o,onActionClick:r})=>{const{formatMessage:d}=(0,L.Z)(),c=gt({isFiltering:l,canCreate:n,canRead:o});return e.createElement(mt.i,{icon:o?null:ut.Z,action:n&&!l&&e.createElement(Z.z,{variant:"secondary",startIcon:e.createElement(K.Z,null),onClick:r},d({id:(0,i.OB)("header.actions.add-assets"),defaultMessage:"Add new assets"})),content:d({...c,id:(0,i.OB)(c.id)})})};re.propTypes={canCreate:g().bool.isRequired,canRead:g().bool.isRequired,isFiltering:g().bool.isRequired,onActionClick:g().func.isRequired};var ft=t(89597),Et=t(51386),vt=t(45219),ie=t(97581);const pt=()=>{const n=(0,e.useRef)(null),[l,o]=(0,e.useState)(!1),{formatMessage:r}=(0,L.Z)(),{trackUsage:d}=(0,m.useTracking)(),[{query:c},v]=(0,m.useQueryParams)(),E=c?.filters?.$and||[],u=()=>o(s=>!s),h=s=>{v({filters:{$and:s},page:1})},p=s=>{d("didFilterMediaLibraryElements",{location:"content-manager",filter:Object.keys(s[s.length-1])[0]}),v({filters:{$and:s},page:1})};return e.createElement(e.Fragment,null,e.createElement(Z.z,{variant:"tertiary",ref:n,startIcon:e.createElement(ft.Z,null),onClick:u,size:"S"},r({id:"app.utils.filters",defaultMessage:"Filters"})),l&&e.createElement(vt.Z,{displayedFilters:ie.Z,filters:E,onSubmit:p,onToggle:u,source:n}),e.createElement(Et.Z,{appliedFilters:E,filtersSchema:ie.Z,onRemoveFilter:h}))};var ht=t(53979),yt=t(23620),Ct=t(67109),Mt=t(48038);const J=({breadcrumbs:n,canCreate:l,folder:o,onToggleEditFolderDialog:r,onToggleUploadAssetDialog:d})=>{const{formatMessage:c}=(0,L.Z)(),{pathname:v}=(0,D.TH)(),[{query:E}]=(0,m.useQueryParams)(),u={...E,folder:o?.parent?.id??void 0};return e.createElement(ht.T,{title:c({id:(0,i.OB)("plugin.name"),defaultMessage:"Media Library"}),subtitle:n&&o&&e.createElement(Mt.O,{as:"nav",label:c({id:(0,i.OB)("header.breadcrumbs.nav.label"),defaultMessage:"Folders navigation"}),breadcrumbs:n,currentFolderId:o?.id}),navigationAction:o&&e.createElement(yt.r,{startIcon:e.createElement(Ct.Z,null),to:`${v}?${(0,ae.stringify)(u,{encode:!1})}`},c({id:(0,i.OB)("header.actions.folder-level-up"),defaultMessage:"Back"})),primaryAction:l&&e.createElement(O.k,{gap:2},e.createElement(Z.z,{startIcon:e.createElement(K.Z,null),variant:"secondary",onClick:r},c({id:(0,i.OB)("header.actions.add-folder"),defaultMessage:"Add new folder"})),e.createElement(Z.z,{startIcon:e.createElement(K.Z,null),onClick:d},c({id:(0,i.OB)("header.actions.add-assets"),defaultMessage:"Add new assets"})))})};J.defaultProps={breadcrumbs:!1,folder:null},J.propTypes={breadcrumbs:g().oneOfType([f.Fv,g().bool]),canCreate:g().bool.isRequired,folder:f.nx,onToggleEditFolderDialog:g().func.isRequired,onToggleUploadAssetDialog:g().func.isRequired};const Ft=(0,G.ZP)(R.x)`
  height: ${32/16}rem;
  display: flex;
  align-items: center;
`,de=(0,G.ZP)(x.Z)`
  max-width: 100%;
`,ce=(0,G.ZP)(R.x)`
  svg {
    path {
      fill: ${({theme:n})=>n.colors.neutral500};
    }
  }
`,St=()=>{const{push:n}=(0,D.k6)(),{canRead:l,canCreate:o,canUpdate:r,canCopyLink:d,canDownload:c,isLoading:v}=(0,Xe.y)(),E=(0,e.useRef)(),{formatMessage:u}=(0,L.Z)(),{pathname:h}=(0,D.TH)(),{trackUsage:p}=(0,m.useTracking)(),[{query:s},B]=(0,m.useQueryParams)(),M=Boolean(s._q||s.filters),[T,z]=(0,m.usePersistentState)(f.uf.view,f.Uk.GRID),F=T===f.Uk.GRID,{data:S,isLoading:At,errors:Zt}=(0,Ne.L)({skipWhen:!l,query:s}),{data:Tt,isLoading:Dt,errors:Ot}=(0,Je.j)({enabled:l&&S?.pagination?.page===1&&!(0,i.rV)(s),query:s}),{data:X,isLoading:ue,error:Pt}=(0,Ke.W)(s?.folder,{enabled:l&&!!s?.folder});Pt?.response?.status===404&&n(h);const U=Tt?.map(a=>({...a,type:"folder",folderURL:(0,i.Km)(h,s,a.id),isSelectable:r}))??[],y=U?.length||0,Q=S?.results?.map(a=>({...a,type:"asset",isSelectable:r}))||[],C=Q?.length??0,Rt=S?.pagination?.total,me=ue||Dt||v||At,[xt,It]=(0,e.useState)(!1),[zt,ge]=(0,e.useState)(!1),[fe,Y]=(0,e.useState)(void 0),[k,Ee]=(0,e.useState)(void 0),[A,{selectOne:V,selectAll:ve}]=(0,m.useSelectionState)(["type","id"],[]),pe=A?.length>0&&A?.length!==C+y,w=()=>It(a=>!a),he=({created:a=!1}={})=>{a&&s?.page!=="1"&&B({...s,page:1}),ge($=>!$)},ye=(a,$)=>{a.target.checked&&p("didSelectAllMediaLibraryElements"),ve($)},Ce=a=>{p("didSortMediaLibraryElements",{location:"upload",sort:a}),B({sort:a})},Me=a=>{Ee(a),ge(!0)},Ut=a=>{Ee(null),he(a),E.current&&E.current.focus()},Fe=a=>{a===C&&S.pagination.page===S.pagination.pageCount&&S.pagination.page>1&&B({...s,page:S.pagination.page-1})},Qt=()=>{ve(),Fe(A.length)};return(0,m.useFocusWhenNavigate)(),e.createElement(Ae.A,null,e.createElement(ee.o,{"aria-busy":me},e.createElement(J,{breadcrumbs:!ue&&(0,i.M4)(X,{pathname:h,query:s}),canCreate:o,onToggleEditFolderDialog:he,onToggleUploadAssetDialog:w,folder:X}),e.createElement(Ze.Z,{startActions:e.createElement(e.Fragment,null,r&&F&&(C>0||y>0)&&e.createElement(Ft,{paddingLeft:2,paddingRight:2,background:"neutral0",hasRadius:!0,borderColor:"neutral200"},e.createElement(Te.C,{"aria-label":u({id:(0,i.OB)("bulk.select.label"),defaultMessage:"Select all folders & assets"}),indeterminate:pe,value:(C>0||y>0)&&A.length===C+y,onChange:a=>ye(a,[...Q,...U])})),l&&F&&e.createElement(We.Z,{onChangeSort:Ce}),l&&e.createElement(pt,null)),endActions:e.createElement(e.Fragment,null,e.createElement(m.CheckPermissions,{permissions:Ye.Z.configureView},e.createElement(ce,{paddingTop:1,paddingBottom:1},e.createElement(b.h,{forwardedAs:Ue.Link,to:{pathname:`${h}/configuration`,search:(0,ae.stringify)(s,{encode:!1})},icon:e.createElement(Re.Z,null),label:u({id:"app.links.configure-view",defaultMessage:"Configure the view"})}))),e.createElement(ce,{paddingTop:1,paddingBottom:1},e.createElement(b.h,{icon:F?e.createElement(xe.Z,null):e.createElement(Ie.Z,null),label:u(F?{id:(0,i.OB)("view-switch.list"),defaultMessage:"List View"}:{id:(0,i.OB)("view-switch.grid"),defaultMessage:"Grid View"}),onClick:()=>z(F?f.Uk.LIST:f.Uk.GRID)})),e.createElement(m.SearchURLQuery,{label:u({id:(0,i.OB)("search.label"),defaultMessage:"Search for an asset"}),trackedEvent:"didSearchMediaLibraryElements",trackedEventDetails:{location:"upload"}}))}),e.createElement(De.D,null,A.length>0&&e.createElement(N,{currentFolder:X,selected:A,onSuccess:Qt}),me&&e.createElement(m.LoadingIndicatorPage,null),(Zt||Ot)&&e.createElement(m.AnErrorOccurred,null),y===0&&C===0&&e.createElement(re,{canCreate:o,canRead:l,isFiltering:M,onActionClick:w}),l&&!F&&(C>0||y>0)&&e.createElement(He.b,{assetCount:C,folderCount:y,indeterminate:pe,onChangeSort:Ce,onChangeFolder:a=>n((0,i.Km)(h,s,a)),onEditAsset:Y,onEditFolder:Me,onSelectOne:V,onSelectAll:ye,rows:[...U,...Q],selected:A,shouldDisableBulkSelect:!r,sortQuery:s?.sort??""}),l&&F&&e.createElement(e.Fragment,null,y>0&&e.createElement(be.a,{title:(M&&C>0||!M)&&u({id:(0,i.OB)("list.folders.title"),defaultMessage:"Folders ({count})"},{count:y})||""},U.map(a=>{const Vt=!!A.filter(({type:q})=>q==="folder").find(q=>q.id===a.id),Se=(0,i.Km)(h,s,a?.id);return e.createElement(te.P,{col:3,key:`folder-${a.id}`},e.createElement(I.Ac,{ref:k&&a.id===k.id?E:void 0,ariaLabel:a.name,id:`folder-${a.id}`,to:Se,startAction:V&&a.isSelectable?e.createElement(I.MM,{"data-testid":`folder-checkbox-${a.id}`,value:Vt,onChange:()=>V(a)}):null,cardActions:e.createElement(b.h,{icon:e.createElement(ze.Z,null),"aria-label":u({id:(0,i.OB)("list.folder.edit"),defaultMessage:"Edit folder"}),onClick:()=>Me(a)})},e.createElement(I.Bu,null,e.createElement(I.u6,{to:Se},e.createElement(O.k,{as:"h2",direction:"column",alignItems:"start",maxWidth:"100%"},e.createElement(de,{fontWeight:"semiBold",ellipsis:!0},a.name,e.createElement(Oe.T,null,":")),e.createElement(de,{as:"span",textColor:"neutral600",variant:"pi",ellipsis:!0},u({id:(0,i.OB)("list.folder.subtitle"),defaultMessage:"{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"},{folderCount:a.children.count,filesCount:a.files.count})))))))})),C>0&&y>0&&e.createElement(R.x,{paddingTop:6,paddingBottom:4},e.createElement(Pe.i,null)),C>0&&e.createElement(Qe.r,{assets:Q,onEditAsset:Y,onSelectAsset:V,selectedAssets:A.filter(({type:a})=>a==="asset"),title:(!M||M&&y>0)&&S?.pagination?.page===1&&u({id:(0,i.OB)("list.assets.title"),defaultMessage:"Assets ({count})"},{count:Rt})||""})),S?.pagination&&e.createElement(W,{pagination:S.pagination}))),xt&&e.createElement(je.x,{onClose:w,trackedLocation:"upload",folderId:s?.folder}),zt&&e.createElement($e.f,{onClose:Ut,folder:k,parentFolderId:s?.folder,location:"upload"}),fe&&e.createElement(Ve.s,{onClose:a=>{a===null&&Fe(1),Y(void 0)},asset:fe,canUpdate:r,canCopyLink:d,canDownload:c,trackedLocation:"upload"}))},Lt=(0,e.lazy)(()=>t.e(9514).then(t.bind(t,87532))),Bt=()=>{const{config:{isLoading:n,isError:l,data:o}}=(0,Be.Z)(),[{rawQuery:r},d]=(0,m.useQueryParams)(),{formatMessage:c}=(0,L.Z)(),v=c({id:(0,i.OB)("plugin.name"),defaultMessage:"Media Library"});return(0,e.useEffect)(()=>{n||l||r||d({sort:o.sort,page:1,pageSize:o.pageSize})},[n,l,o,r,d]),(0,m.useFocusWhenNavigate)(),e.createElement(ee.o,{"aria-busy":n},e.createElement(Le.q,{title:v}),n&&e.createElement(m.LoadingIndicatorPage,null),r?e.createElement(e.Suspense,{fallback:e.createElement(m.LoadingIndicatorPage,null)},e.createElement(D.rs,null,e.createElement(D.AW,{exact:!0,path:`/plugins/${P.Z}`,component:St}),e.createElement(D.AW,{exact:!0,path:`/plugins/${P.Z}/configuration`,render:()=>e.createElement(Lt,{config:o})}))):null)}}}]);
